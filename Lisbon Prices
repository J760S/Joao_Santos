{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from bs4 import BeautifulSoup\n",
    "import requests\n",
    "import folium"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"Livro2.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Concelho</th>\n",
       "      <th>Prices</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arruda dos Vinhos</td>\n",
       "      <td>846</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Cadaval</td>\n",
       "      <td>534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Loures</td>\n",
       "      <td>1251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>823</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Mafra</td>\n",
       "      <td>1037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Odivelas</td>\n",
       "      <td>1243</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Oeiras</td>\n",
       "      <td>1572</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Sintra</td>\n",
       "      <td>853</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>630</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>863</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>938</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  Concelho  Prices\n",
       "0                 Alenquer     686\n",
       "1                  Amadora    1006\n",
       "2        Arruda dos Vinhos     846\n",
       "3                 Azambuja     675\n",
       "4                  Cadaval     534\n",
       "5                  Cascais    1893\n",
       "6                   Lisboa    2315\n",
       "7                   Loures    1251\n",
       "8                 Lourinhã     823\n",
       "9                    Mafra    1037\n",
       "10                Odivelas    1243\n",
       "11                  Oeiras    1572\n",
       "12                  Sintra     853\n",
       "13  Sobral de Monte Agraço     630\n",
       "14           Torres Vedras     863\n",
       "15     Vila Franca de Xira     938"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>County</th>\n",
       "      <th>Prices</th>\n",
       "      <th>District</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arruda dos Vinhos</td>\n",
       "      <td>846</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Cadaval</td>\n",
       "      <td>534</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Loures</td>\n",
       "      <td>1251</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>823</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Mafra</td>\n",
       "      <td>1037</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Odivelas</td>\n",
       "      <td>1243</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Oeiras</td>\n",
       "      <td>1572</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Sintra</td>\n",
       "      <td>853</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>630</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>863</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>938</td>\n",
       "      <td>Lisbon</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    County  Prices District\n",
       "0                 Alenquer     686   Lisbon\n",
       "1                  Amadora    1006   Lisbon\n",
       "2        Arruda dos Vinhos     846   Lisbon\n",
       "3                 Azambuja     675   Lisbon\n",
       "4                  Cadaval     534   Lisbon\n",
       "5                  Cascais    1893   Lisbon\n",
       "6                   Lisboa    2315   Lisbon\n",
       "7                   Loures    1251   Lisbon\n",
       "8                 Lourinhã     823   Lisbon\n",
       "9                    Mafra    1037   Lisbon\n",
       "10                Odivelas    1243   Lisbon\n",
       "11                  Oeiras    1572   Lisbon\n",
       "12                  Sintra     853   Lisbon\n",
       "13  Sobral de Monte Agraço     630   Lisbon\n",
       "14           Torres Vedras     863   Lisbon\n",
       "15     Vila Franca de Xira     938   Lisbon"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['District'] = \"Lisbon\"\n",
    "df1 = df.rename(columns={\"Concelho\":\"County\"})\n",
    "df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>District</th>\n",
       "      <th>County</th>\n",
       "      <th>Prices</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Arruda dos Vinhos</td>\n",
       "      <td>846</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cadaval</td>\n",
       "      <td>534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Loures</td>\n",
       "      <td>1251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>823</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Mafra</td>\n",
       "      <td>1037</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Odivelas</td>\n",
       "      <td>1243</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Oeiras</td>\n",
       "      <td>1572</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Sintra</td>\n",
       "      <td>853</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>630</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>863</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>938</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   District                  County  Prices\n",
       "0    Lisbon                Alenquer     686\n",
       "1    Lisbon                 Amadora    1006\n",
       "2    Lisbon       Arruda dos Vinhos     846\n",
       "3    Lisbon                Azambuja     675\n",
       "4    Lisbon                 Cadaval     534\n",
       "5    Lisbon                 Cascais    1893\n",
       "6    Lisbon                  Lisboa    2315\n",
       "7    Lisbon                  Loures    1251\n",
       "8    Lisbon                Lourinhã     823\n",
       "9    Lisbon                   Mafra    1037\n",
       "10   Lisbon                Odivelas    1243\n",
       "11   Lisbon                  Oeiras    1572\n",
       "12   Lisbon                  Sintra     853\n",
       "13   Lisbon  Sobral de Monte Agraço     630\n",
       "14   Lisbon           Torres Vedras     863\n",
       "15   Lisbon     Vila Franca de Xira     938"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cols =[\"District\", \"County\", \"Prices\"]\n",
    "\n",
    "df = df1[cols]\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "County = df[\"County\"].tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Alenquer': (39.056633, -9.0076057),\n",
       " 'Amadora': (38.7595162, -9.22367700946013),\n",
       " 'Arruda dos Vinhos': (38.97514755, -9.08770297531722),\n",
       " 'Azambuja': (39.0689884, -8.8684921),\n",
       " 'Cadaval': (39.2395742, -9.0622031057665),\n",
       " 'Cascais': (38.72240025, -9.39690917164988),\n",
       " 'Lisboa': (38.7077507, -9.1365919),\n",
       " 'Loures': (38.8308741, -9.1684512),\n",
       " 'Lourinhã': (39.2460331, -9.27133879080639),\n",
       " 'Mafra': (-26.1150943, -49.8035982),\n",
       " 'Odivelas': (38.7926342, -9.1826701),\n",
       " 'Oeiras': (-7.0109909, -42.1299376),\n",
       " 'Sintra': (38.8355605, -9.35222525884862),\n",
       " 'Sobral de Monte Agraço': (39.01835, -9.15171),\n",
       " 'Torres Vedras': (39.0930856, -9.260741),\n",
       " 'Vila Franca de Xira': (38.954278, -8.9897039)}"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from geopy.geocoders import Nominatim\n",
    "geolocator = Nominatim(user_agent=\"ny_explorer\")\n",
    "\n",
    "dict_GPS = {}\n",
    "\n",
    "for i in County:\n",
    "    location = geolocator.geocode(i)\n",
    "    \n",
    "    x={i:(location.latitude, location.longitude)}\n",
    "    dict_GPS.update(x)\n",
    "    \n",
    "dict_GPS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Geopy goes for Mafra and Oeiras in brazil, we need to change that!\n",
    "\n",
    "location_mafra = geolocator.geocode(\"Mafra, PT\")\n",
    "location_oeiras = geolocator.geocode(\"Oeiras, PT\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Alenquer': (39.056633, -9.0076057),\n",
       " 'Amadora': (38.7595162, -9.22367700946013),\n",
       " 'Arruda dos Vinhos': (38.97514755, -9.08770297531722),\n",
       " 'Azambuja': (39.0689884, -8.8684921),\n",
       " 'Cadaval': (39.2395742, -9.0622031057665),\n",
       " 'Cascais': (38.72240025, -9.39690917164988),\n",
       " 'Lisboa': (38.7077507, -9.1365919),\n",
       " 'Loures': (38.8308741, -9.1684512),\n",
       " 'Lourinhã': (39.2460331, -9.27133879080639),\n",
       " 'Mafra': (38.9369782, -9.3282374),\n",
       " 'Odivelas': (38.7926342, -9.1826701),\n",
       " 'Oeiras': (38.7124971, -9.27130038240727),\n",
       " 'Sintra': (38.8355605, -9.35222525884862),\n",
       " 'Sobral de Monte Agraço': (39.01835, -9.15171),\n",
       " 'Torres Vedras': (39.0930856, -9.260741),\n",
       " 'Vila Franca de Xira': (38.954278, -8.9897039)}"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dict_GPS.update({'Mafra': (location_mafra.latitude, location_mafra.longitude)})\n",
    "dict_GPS.update({'Oeiras': (location_oeiras.latitude, location_oeiras.longitude)})\n",
    "dict_GPS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>County</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Amadora</td>\n",
       "      <td>38.759516</td>\n",
       "      <td>-9.223677</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Arruda dos Vinhos</td>\n",
       "      <td>38.975148</td>\n",
       "      <td>-9.087703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Azambuja</td>\n",
       "      <td>39.068988</td>\n",
       "      <td>-8.868492</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Cadaval</td>\n",
       "      <td>39.239574</td>\n",
       "      <td>-9.062203</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cascais</td>\n",
       "      <td>38.722400</td>\n",
       "      <td>-9.396909</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisboa</td>\n",
       "      <td>38.707751</td>\n",
       "      <td>-9.136592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Loures</td>\n",
       "      <td>38.830874</td>\n",
       "      <td>-9.168451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>39.246033</td>\n",
       "      <td>-9.271339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Mafra</td>\n",
       "      <td>38.936978</td>\n",
       "      <td>-9.328237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Odivelas</td>\n",
       "      <td>38.792634</td>\n",
       "      <td>-9.182670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Oeiras</td>\n",
       "      <td>38.712497</td>\n",
       "      <td>-9.271300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Sintra</td>\n",
       "      <td>38.835560</td>\n",
       "      <td>-9.352225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>39.018350</td>\n",
       "      <td>-9.151710</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>39.093086</td>\n",
       "      <td>-9.260741</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>38.954278</td>\n",
       "      <td>-8.989704</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    County   Latitude  Longitude\n",
       "0                 Alenquer  39.056633  -9.007606\n",
       "1                  Amadora  38.759516  -9.223677\n",
       "2        Arruda dos Vinhos  38.975148  -9.087703\n",
       "3                 Azambuja  39.068988  -8.868492\n",
       "4                  Cadaval  39.239574  -9.062203\n",
       "5                  Cascais  38.722400  -9.396909\n",
       "6                   Lisboa  38.707751  -9.136592\n",
       "7                   Loures  38.830874  -9.168451\n",
       "8                 Lourinhã  39.246033  -9.271339\n",
       "9                    Mafra  38.936978  -9.328237\n",
       "10                Odivelas  38.792634  -9.182670\n",
       "11                  Oeiras  38.712497  -9.271300\n",
       "12                  Sintra  38.835560  -9.352225\n",
       "13  Sobral de Monte Agraço  39.018350  -9.151710\n",
       "14           Torres Vedras  39.093086  -9.260741\n",
       "15     Vila Franca de Xira  38.954278  -8.989704"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "columns = [\"Latitude\", \"Longitude\"]\n",
    "\n",
    "GPS = pd.DataFrame.from_dict(dict_GPS, columns= columns, orient='index').reset_index().rename(columns={\"index\":\"County\"})\n",
    "GPS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>District</th>\n",
       "      <th>County</th>\n",
       "      <th>Prices</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "      <td>38.759516</td>\n",
       "      <td>-9.223677</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Arruda dos Vinhos</td>\n",
       "      <td>846</td>\n",
       "      <td>38.975148</td>\n",
       "      <td>-9.087703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "      <td>39.068988</td>\n",
       "      <td>-8.868492</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cadaval</td>\n",
       "      <td>534</td>\n",
       "      <td>39.239574</td>\n",
       "      <td>-9.062203</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "      <td>38.722400</td>\n",
       "      <td>-9.396909</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "      <td>38.707751</td>\n",
       "      <td>-9.136592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Loures</td>\n",
       "      <td>1251</td>\n",
       "      <td>38.830874</td>\n",
       "      <td>-9.168451</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>823</td>\n",
       "      <td>39.246033</td>\n",
       "      <td>-9.271339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Mafra</td>\n",
       "      <td>1037</td>\n",
       "      <td>38.936978</td>\n",
       "      <td>-9.328237</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Odivelas</td>\n",
       "      <td>1243</td>\n",
       "      <td>38.792634</td>\n",
       "      <td>-9.182670</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Oeiras</td>\n",
       "      <td>1572</td>\n",
       "      <td>38.712497</td>\n",
       "      <td>-9.271300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Sintra</td>\n",
       "      <td>853</td>\n",
       "      <td>38.835560</td>\n",
       "      <td>-9.352225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>630</td>\n",
       "      <td>39.018350</td>\n",
       "      <td>-9.151710</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>863</td>\n",
       "      <td>39.093086</td>\n",
       "      <td>-9.260741</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>938</td>\n",
       "      <td>38.954278</td>\n",
       "      <td>-8.989704</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   District                  County  Prices   Latitude  Longitude\n",
       "0    Lisbon                Alenquer     686  39.056633  -9.007606\n",
       "1    Lisbon                 Amadora    1006  38.759516  -9.223677\n",
       "2    Lisbon       Arruda dos Vinhos     846  38.975148  -9.087703\n",
       "3    Lisbon                Azambuja     675  39.068988  -8.868492\n",
       "4    Lisbon                 Cadaval     534  39.239574  -9.062203\n",
       "5    Lisbon                 Cascais    1893  38.722400  -9.396909\n",
       "6    Lisbon                  Lisboa    2315  38.707751  -9.136592\n",
       "7    Lisbon                  Loures    1251  38.830874  -9.168451\n",
       "8    Lisbon                Lourinhã     823  39.246033  -9.271339\n",
       "9    Lisbon                   Mafra    1037  38.936978  -9.328237\n",
       "10   Lisbon                Odivelas    1243  38.792634  -9.182670\n",
       "11   Lisbon                  Oeiras    1572  38.712497  -9.271300\n",
       "12   Lisbon                  Sintra     853  38.835560  -9.352225\n",
       "13   Lisbon  Sobral de Monte Agraço     630  39.018350  -9.151710\n",
       "14   Lisbon           Torres Vedras     863  39.093086  -9.260741\n",
       "15   Lisbon     Vila Franca de Xira     938  38.954278  -8.989704"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Prices_GPS = pd.merge(df, GPS, on='County')\n",
    "Prices_GPS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "CLIENT_ID = 'X342CSELWXETJ2ZT4CZQRKL5D4LFVKT1XLM33Q1ZDNMB1XKP' # your Foursquare ID\n",
    "CLIENT_SECRET = '0IKUUDY34PFCPNMFNMNEOHSM2D5YQMRMJYKA3BWC1T4YUG2O' # your Foursquare Secret\n",
    "VERSION = '20180605' # Foursquare API version"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "def getNearbyVenues(names, latitudes, longitudes, radius=500, LIMIT=100):\n",
    "    \n",
    "    venues_list=[]\n",
    "    for name, lat, lng in zip(names, latitudes, longitudes):\n",
    "        print(name)\n",
    "            \n",
    "        # create the API request URL\n",
    "        url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}'.format(\n",
    "            CLIENT_ID, \n",
    "            CLIENT_SECRET, \n",
    "            VERSION, \n",
    "            lat, \n",
    "            lng, \n",
    "            radius, \n",
    "            LIMIT)\n",
    "            \n",
    "        # make the GET request\n",
    "        results = requests.get(url).json()[\"response\"]['groups'][0]['items']\n",
    "        \n",
    "        # return only relevant information for each nearby venue\n",
    "        venues_list.append([(\n",
    "            name, \n",
    "            lat, \n",
    "            lng, \n",
    "            v['venue']['name'], \n",
    "            v['venue']['location']['lat'], \n",
    "            v['venue']['location']['lng'],  \n",
    "            v['venue']['categories'][0]['name']) for v in results])\n",
    "\n",
    "    nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])\n",
    "    nearby_venues.columns = ['County', \n",
    "                  'County Latitude', \n",
    "                  'County Longitude', \n",
    "                  'Venue', \n",
    "                  'Venue Latitude', \n",
    "                  'Venue Longitude', \n",
    "                  'Venue Category']\n",
    "    \n",
    "    return(nearby_venues)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Alenquer\n",
      "Amadora\n",
      "Arruda dos Vinhos\n",
      "Azambuja\n",
      "Cadaval\n",
      "Cascais\n",
      "Lisboa\n",
      "Loures\n",
      "Lourinhã\n",
      "Mafra\n",
      "Odivelas\n",
      "Oeiras\n",
      "Sintra\n",
      "Sobral de Monte Agraço\n",
      "Torres Vedras\n",
      "Vila Franca de Xira\n"
     ]
    }
   ],
   "source": [
    "downtown_venues = getNearbyVenues(names=Prices_GPS['County'],\n",
    "                                   latitudes=Prices_GPS['Latitude'],\n",
    "                                   longitudes=Prices_GPS['Longitude'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>County</th>\n",
       "      <th>County Latitude</th>\n",
       "      <th>County Longitude</th>\n",
       "      <th>Venue</th>\n",
       "      <th>Venue Latitude</th>\n",
       "      <th>Venue Longitude</th>\n",
       "      <th>Venue Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>Taberna do Areal</td>\n",
       "      <td>39.057878</td>\n",
       "      <td>-9.006129</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>Taberna Chapéu Alto</td>\n",
       "      <td>39.055238</td>\n",
       "      <td>-9.010080</td>\n",
       "      <td>Wine Bar</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>Confraria do Café - Alenquer</td>\n",
       "      <td>39.052898</td>\n",
       "      <td>-9.009088</td>\n",
       "      <td>Bakery</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>Casta 85</td>\n",
       "      <td>39.052876</td>\n",
       "      <td>-9.009241</td>\n",
       "      <td>Modern European Restaurant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>Biju</td>\n",
       "      <td>39.055000</td>\n",
       "      <td>-9.007645</td>\n",
       "      <td>Bar</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     County  County Latitude  County Longitude                         Venue  \\\n",
       "0  Alenquer        39.056633         -9.007606              Taberna do Areal   \n",
       "1  Alenquer        39.056633         -9.007606           Taberna Chapéu Alto   \n",
       "2  Alenquer        39.056633         -9.007606  Confraria do Café - Alenquer   \n",
       "3  Alenquer        39.056633         -9.007606                      Casta 85   \n",
       "4  Alenquer        39.056633         -9.007606                          Biju   \n",
       "\n",
       "   Venue Latitude  Venue Longitude              Venue Category  \n",
       "0       39.057878        -9.006129       Portuguese Restaurant  \n",
       "1       39.055238        -9.010080                    Wine Bar  \n",
       "2       39.052898        -9.009088                      Bakery  \n",
       "3       39.052876        -9.009241  Modern European Restaurant  \n",
       "4       39.055000        -9.007645                         Bar  "
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "downtown_venues.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>County</th>\n",
       "      <th>African Restaurant</th>\n",
       "      <th>Arts &amp; Crafts Store</th>\n",
       "      <th>BBQ Joint</th>\n",
       "      <th>Bagel Shop</th>\n",
       "      <th>Bakery</th>\n",
       "      <th>Bar</th>\n",
       "      <th>Beer Bar</th>\n",
       "      <th>Beer Garden</th>\n",
       "      <th>Botanical Garden</th>\n",
       "      <th>...</th>\n",
       "      <th>Soccer Field</th>\n",
       "      <th>Soccer Stadium</th>\n",
       "      <th>Stadium</th>\n",
       "      <th>Supermarket</th>\n",
       "      <th>Sushi Restaurant</th>\n",
       "      <th>Tapas Restaurant</th>\n",
       "      <th>Theater</th>\n",
       "      <th>Train Station</th>\n",
       "      <th>Vegetarian / Vegan Restaurant</th>\n",
       "      <th>Wine Bar</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 76 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     County  African Restaurant  Arts & Crafts Store  BBQ Joint  Bagel Shop  \\\n",
       "0  Alenquer                   0                    0          0           0   \n",
       "1  Alenquer                   0                    0          0           0   \n",
       "2  Alenquer                   0                    0          0           0   \n",
       "3  Alenquer                   0                    0          0           0   \n",
       "4  Alenquer                   0                    0          0           0   \n",
       "\n",
       "   Bakery  Bar  Beer Bar  Beer Garden  Botanical Garden  ...  Soccer Field  \\\n",
       "0       0    0         0            0                 0  ...             0   \n",
       "1       0    0         0            0                 0  ...             0   \n",
       "2       1    0         0            0                 0  ...             0   \n",
       "3       0    0         0            0                 0  ...             0   \n",
       "4       0    1         0            0                 0  ...             0   \n",
       "\n",
       "   Soccer Stadium  Stadium  Supermarket  Sushi Restaurant  Tapas Restaurant  \\\n",
       "0               0        0            0                 0                 0   \n",
       "1               0        0            0                 0                 0   \n",
       "2               0        0            0                 0                 0   \n",
       "3               0        0            0                 0                 0   \n",
       "4               0        0            0                 0                 0   \n",
       "\n",
       "   Theater  Train Station  Vegetarian / Vegan Restaurant  Wine Bar  \n",
       "0        0              0                              0         0  \n",
       "1        0              0                              0         1  \n",
       "2        0              0                              0         0  \n",
       "3        0              0                              0         0  \n",
       "4        0              0                              0         0  \n",
       "\n",
       "[5 rows x 76 columns]"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# one hot encoding\n",
    "manhattan_onehot = pd.get_dummies(downtown_venues[['Venue Category']], prefix=\"\", prefix_sep=\"\")\n",
    "\n",
    "# add neighborhood column back to dataframe\n",
    "manhattan_onehot['County'] = downtown_venues['County'] \n",
    "\n",
    "# move neighborhood column to the first column\n",
    "fixed_columns = [manhattan_onehot.columns[-1]] + list(manhattan_onehot.columns[:-1])\n",
    "manhattan_onehot = manhattan_onehot[fixed_columns]\n",
    "\n",
    "manhattan_onehot.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>County</th>\n",
       "      <th>African Restaurant</th>\n",
       "      <th>Arts &amp; Crafts Store</th>\n",
       "      <th>BBQ Joint</th>\n",
       "      <th>Bagel Shop</th>\n",
       "      <th>Bakery</th>\n",
       "      <th>Bar</th>\n",
       "      <th>Beer Bar</th>\n",
       "      <th>Beer Garden</th>\n",
       "      <th>Botanical Garden</th>\n",
       "      <th>...</th>\n",
       "      <th>Soccer Field</th>\n",
       "      <th>Soccer Stadium</th>\n",
       "      <th>Stadium</th>\n",
       "      <th>Supermarket</th>\n",
       "      <th>Sushi Restaurant</th>\n",
       "      <th>Tapas Restaurant</th>\n",
       "      <th>Theater</th>\n",
       "      <th>Train Station</th>\n",
       "      <th>Vegetarian / Vegan Restaurant</th>\n",
       "      <th>Wine Bar</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.125</td>\n",
       "      <td>0.25</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Amadora</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.100</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Azambuja</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Cascais</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Lisboa</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.020</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.040</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 76 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     County  African Restaurant  Arts & Crafts Store  BBQ Joint  Bagel Shop  \\\n",
       "0  Alenquer                0.00                 0.00        0.0         0.0   \n",
       "1   Amadora                0.00                 0.00        0.0         0.0   \n",
       "2  Azambuja                0.00                 0.00        0.0         0.0   \n",
       "3   Cascais                0.00                 0.00        0.0         0.0   \n",
       "4    Lisboa                0.01                 0.01        0.0         0.0   \n",
       "\n",
       "   Bakery   Bar  Beer Bar  Beer Garden  Botanical Garden  ...  Soccer Field  \\\n",
       "0   0.125  0.25      0.00         0.00               0.0  ...           0.0   \n",
       "1   0.100  0.00      0.00         0.00               0.0  ...           0.0   \n",
       "2   0.000  0.00      0.00         0.00               0.0  ...           0.0   \n",
       "3   0.000  0.00      0.00         0.00               0.0  ...           0.0   \n",
       "4   0.020  0.04      0.01         0.01               0.0  ...           0.0   \n",
       "\n",
       "   Soccer Stadium  Stadium  Supermarket  Sushi Restaurant  Tapas Restaurant  \\\n",
       "0             0.0      0.0          0.0               0.0              0.00   \n",
       "1             0.0      0.0          0.1               0.0              0.00   \n",
       "2             0.0      0.0          0.0               0.0              0.00   \n",
       "3             0.0      0.0          0.0               0.0              0.00   \n",
       "4             0.0      0.0          0.0               0.0              0.03   \n",
       "\n",
       "   Theater  Train Station  Vegetarian / Vegan Restaurant  Wine Bar  \n",
       "0      0.0       0.000000                           0.00     0.125  \n",
       "1      0.0       0.000000                           0.00     0.000  \n",
       "2      0.0       0.142857                           0.00     0.000  \n",
       "3      0.0       0.000000                           0.00     0.000  \n",
       "4      0.0       0.000000                           0.01     0.040  \n",
       "\n",
       "[5 rows x 76 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "manhattan_grouped = manhattan_onehot.groupby('County').mean().reset_index()\n",
    "manhattan_grouped.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "def return_most_common_venues(row, num_top_venues):\n",
    "    row_categories = row.iloc[1:]\n",
    "    row_categories_sorted = row_categories.sort_values(ascending=False)\n",
    "    \n",
    "    return row_categories_sorted.index.values[0:num_top_venues]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>County</th>\n",
       "      <th>1st Most Common Venue</th>\n",
       "      <th>2nd Most Common Venue</th>\n",
       "      <th>3rd Most Common Venue</th>\n",
       "      <th>4th Most Common Venue</th>\n",
       "      <th>5th Most Common Venue</th>\n",
       "      <th>6th Most Common Venue</th>\n",
       "      <th>7th Most Common Venue</th>\n",
       "      <th>8th Most Common Venue</th>\n",
       "      <th>9th Most Common Venue</th>\n",
       "      <th>10th Most Common Venue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Alenquer</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Other Great Outdoors</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Modern European Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Amadora</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Gym</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Supermarket</td>\n",
       "      <td>Metro Station</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Azambuja</td>\n",
       "      <td>Shopping Mall</td>\n",
       "      <td>Train Station</td>\n",
       "      <td>Café</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Scenic Lookout</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Clothing Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Cascais</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Furniture / Home Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Lisboa</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Hotel</td>\n",
       "      <td>Ice Cream Shop</td>\n",
       "      <td>Plaza</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Hostel</td>\n",
       "      <td>Tapas Restaurant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Loures</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Breakfast Spot</td>\n",
       "      <td>Stadium</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Soccer Stadium</td>\n",
       "      <td>Park</td>\n",
       "      <td>Bar</td>\n",
       "      <td>BBQ Joint</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>Café</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Furniture / Home Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Mafra</td>\n",
       "      <td>Café</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Pizza Place</td>\n",
       "      <td>Botanical Garden</td>\n",
       "      <td>Castle</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Plaza</td>\n",
       "      <td>Burger Joint</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Odivelas</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Pizza Place</td>\n",
       "      <td>Seafood Restaurant</td>\n",
       "      <td>Gym</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Mediterranean Restaurant</td>\n",
       "      <td>Park</td>\n",
       "      <td>Pool</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Oeiras</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Soccer Field</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>City</td>\n",
       "      <td>Clothing Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Sintra</td>\n",
       "      <td>Arts &amp; Crafts Store</td>\n",
       "      <td>Gym / Fitness Center</td>\n",
       "      <td>Breakfast Spot</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>Café</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Tapas Restaurant</td>\n",
       "      <td>Hotel</td>\n",
       "      <td>Brewery</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Historic Site</td>\n",
       "      <td>Market</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Bagel Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Japanese Restaurant</td>\n",
       "      <td>Train Station</td>\n",
       "      <td>Sushi Restaurant</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Café</td>\n",
       "      <td>Market</td>\n",
       "      <td>Shopping Mall</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    County  1st Most Common Venue  2nd Most Common Venue  \\\n",
       "0                 Alenquer                    Bar               Wine Bar   \n",
       "1                  Amadora             Restaurant  Portuguese Restaurant   \n",
       "2                 Azambuja          Shopping Mall          Train Station   \n",
       "3                  Cascais            Golf Course               Wine Bar   \n",
       "4                   Lisboa  Portuguese Restaurant                  Hotel   \n",
       "5                   Loures             Restaurant         Breakfast Spot   \n",
       "6                 Lourinhã                   Café               Wine Bar   \n",
       "7                    Mafra                   Café                 Bakery   \n",
       "8                 Odivelas  Portuguese Restaurant                   Café   \n",
       "9                   Oeiras             Restaurant             Playground   \n",
       "10                  Sintra    Arts & Crafts Store   Gym / Fitness Center   \n",
       "11  Sobral de Monte Agraço                   Café  Portuguese Restaurant   \n",
       "12           Torres Vedras                    Bar       Tapas Restaurant   \n",
       "13     Vila Franca de Xira  Portuguese Restaurant                    Bar   \n",
       "\n",
       "     3rd Most Common Venue  4th Most Common Venue  5th Most Common Venue  \\\n",
       "0     Other Great Outdoors                 Bakery  Portuguese Restaurant   \n",
       "1                      Gym             Playground                 Bakery   \n",
       "2                     Café  Portuguese Restaurant                 Garden   \n",
       "3   Furniture / Home Store            Coffee Shop         Cosmetics Shop   \n",
       "4           Ice Cream Shop                  Plaza                    Bar   \n",
       "5                  Stadium            Coffee Shop       Business Service   \n",
       "6   Furniture / Home Store            Coffee Shop         Cosmetics Shop   \n",
       "7    Portuguese Restaurant             Restaurant            Pizza Place   \n",
       "8              Pizza Place     Seafood Restaurant                    Gym   \n",
       "9    Portuguese Restaurant                 Garden           Soccer Field   \n",
       "10          Breakfast Spot               Wine Bar                 Garden   \n",
       "11                  Garden               Wine Bar   Fast Food Restaurant   \n",
       "12                   Hotel                Brewery             Restaurant   \n",
       "13     Japanese Restaurant          Train Station       Sushi Restaurant   \n",
       "\n",
       "         6th Most Common Venue 7th Most Common Venue  \\\n",
       "0   Modern European Restaurant                  Café   \n",
       "1                  Supermarket         Metro Station   \n",
       "2                        Diner        Scenic Lookout   \n",
       "3                        Diner     Electronics Store   \n",
       "4                     Wine Bar           Coffee Shop   \n",
       "5        Portuguese Restaurant        Soccer Stadium   \n",
       "6                        Diner     Electronics Store   \n",
       "7             Botanical Garden                Castle   \n",
       "8         Fast Food Restaurant           Event Space   \n",
       "9            Electronics Store                  City   \n",
       "10              Cosmetics Shop                 Diner   \n",
       "11                 Coffee Shop        Cosmetics Shop   \n",
       "12                        Café         Historic Site   \n",
       "13                       Diner                Garden   \n",
       "\n",
       "       8th Most Common Venue 9th Most Common Venue 10th Most Common Venue  \n",
       "0       Fast Food Restaurant                 Diner      Electronics Store  \n",
       "1                   Wine Bar     Electronics Store            Coffee Shop  \n",
       "2                Event Space        Clothing Store            Coffee Shop  \n",
       "3                Event Space  Fast Food Restaurant                 Garden  \n",
       "4                 Restaurant                Hostel       Tapas Restaurant  \n",
       "5                       Park                   Bar              BBQ Joint  \n",
       "6                Event Space  Fast Food Restaurant                 Garden  \n",
       "7                Coffee Shop                 Plaza           Burger Joint  \n",
       "8   Mediterranean Restaurant                  Park                   Pool  \n",
       "9             Clothing Store           Coffee Shop         Cosmetics Shop  \n",
       "10         Electronics Store           Event Space   Fast Food Restaurant  \n",
       "11                     Diner     Electronics Store            Event Space  \n",
       "12                    Market                Bakery             Bagel Shop  \n",
       "13                      Café                Market          Shopping Mall  "
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_top_venues = 10\n",
    "\n",
    "indicators = ['st', 'nd', 'rd']\n",
    "\n",
    "# create columns according to number of top venues\n",
    "columns = ['County']\n",
    "for ind in np.arange(num_top_venues):\n",
    "    try:\n",
    "        columns.append('{}{} Most Common Venue'.format(ind+1, indicators[ind]))\n",
    "    except:\n",
    "        columns.append('{}th Most Common Venue'.format(ind+1))\n",
    "\n",
    "# create a new dataframe\n",
    "neighborhoods_venues_sorted = pd.DataFrame(columns=columns)\n",
    "neighborhoods_venues_sorted['County'] = manhattan_grouped['County']\n",
    "\n",
    "for ind in np.arange(manhattan_grouped.shape[0]):\n",
    "    neighborhoods_venues_sorted.iloc[ind, 1:] = return_most_common_venues(manhattan_grouped.iloc[ind, :], num_top_venues)\n",
    "\n",
    "neighborhoods_venues_sorted"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 0, 1, 4, 1, 0, 3, 1, 1, 0])"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.cluster import KMeans\n",
    "\n",
    "# set number of clusters\n",
    "kclusters = 5\n",
    "\n",
    "manhattan_grouped_clustering = manhattan_grouped.drop('County', 1)\n",
    "\n",
    "# run k-means clustering\n",
    "kmeans = KMeans(n_clusters=kclusters, random_state=0).fit(manhattan_grouped_clustering)\n",
    "\n",
    "# check cluster labels generated for each row in the dataframe\n",
    "kmeans.labels_[0:10] "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>District</th>\n",
       "      <th>County</th>\n",
       "      <th>Prices</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Cluster Labels</th>\n",
       "      <th>1st Most Common Venue</th>\n",
       "      <th>2nd Most Common Venue</th>\n",
       "      <th>3rd Most Common Venue</th>\n",
       "      <th>4th Most Common Venue</th>\n",
       "      <th>5th Most Common Venue</th>\n",
       "      <th>6th Most Common Venue</th>\n",
       "      <th>7th Most Common Venue</th>\n",
       "      <th>8th Most Common Venue</th>\n",
       "      <th>9th Most Common Venue</th>\n",
       "      <th>10th Most Common Venue</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Other Great Outdoors</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Modern European Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "      <td>38.759516</td>\n",
       "      <td>-9.223677</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Gym</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Supermarket</td>\n",
       "      <td>Metro Station</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Arruda dos Vinhos</td>\n",
       "      <td>846</td>\n",
       "      <td>38.975148</td>\n",
       "      <td>-9.087703</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "      <td>39.068988</td>\n",
       "      <td>-8.868492</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Shopping Mall</td>\n",
       "      <td>Train Station</td>\n",
       "      <td>Café</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Scenic Lookout</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Clothing Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cadaval</td>\n",
       "      <td>534</td>\n",
       "      <td>39.239574</td>\n",
       "      <td>-9.062203</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "      <td>38.722400</td>\n",
       "      <td>-9.396909</td>\n",
       "      <td>4.0</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Furniture / Home Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "      <td>38.707751</td>\n",
       "      <td>-9.136592</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Hotel</td>\n",
       "      <td>Ice Cream Shop</td>\n",
       "      <td>Plaza</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Hostel</td>\n",
       "      <td>Tapas Restaurant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Loures</td>\n",
       "      <td>1251</td>\n",
       "      <td>38.830874</td>\n",
       "      <td>-9.168451</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Breakfast Spot</td>\n",
       "      <td>Stadium</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Soccer Stadium</td>\n",
       "      <td>Park</td>\n",
       "      <td>Bar</td>\n",
       "      <td>BBQ Joint</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lourinhã</td>\n",
       "      <td>823</td>\n",
       "      <td>39.246033</td>\n",
       "      <td>-9.271339</td>\n",
       "      <td>3.0</td>\n",
       "      <td>Café</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Furniture / Home Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Mafra</td>\n",
       "      <td>1037</td>\n",
       "      <td>38.936978</td>\n",
       "      <td>-9.328237</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Café</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Pizza Place</td>\n",
       "      <td>Botanical Garden</td>\n",
       "      <td>Castle</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Plaza</td>\n",
       "      <td>Burger Joint</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Odivelas</td>\n",
       "      <td>1243</td>\n",
       "      <td>38.792634</td>\n",
       "      <td>-9.182670</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Pizza Place</td>\n",
       "      <td>Seafood Restaurant</td>\n",
       "      <td>Gym</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Mediterranean Restaurant</td>\n",
       "      <td>Park</td>\n",
       "      <td>Pool</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Oeiras</td>\n",
       "      <td>1572</td>\n",
       "      <td>38.712497</td>\n",
       "      <td>-9.271300</td>\n",
       "      <td>0.0</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Soccer Field</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>City</td>\n",
       "      <td>Clothing Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Sintra</td>\n",
       "      <td>853</td>\n",
       "      <td>38.835560</td>\n",
       "      <td>-9.352225</td>\n",
       "      <td>2.0</td>\n",
       "      <td>Arts &amp; Crafts Store</td>\n",
       "      <td>Gym / Fitness Center</td>\n",
       "      <td>Breakfast Spot</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Sobral de Monte Agraço</td>\n",
       "      <td>630</td>\n",
       "      <td>39.018350</td>\n",
       "      <td>-9.151710</td>\n",
       "      <td>3.0</td>\n",
       "      <td>Café</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Torres Vedras</td>\n",
       "      <td>863</td>\n",
       "      <td>39.093086</td>\n",
       "      <td>-9.260741</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Tapas Restaurant</td>\n",
       "      <td>Hotel</td>\n",
       "      <td>Brewery</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Historic Site</td>\n",
       "      <td>Market</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Bagel Shop</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Vila Franca de Xira</td>\n",
       "      <td>938</td>\n",
       "      <td>38.954278</td>\n",
       "      <td>-8.989704</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Japanese Restaurant</td>\n",
       "      <td>Train Station</td>\n",
       "      <td>Sushi Restaurant</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Café</td>\n",
       "      <td>Market</td>\n",
       "      <td>Shopping Mall</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   District                  County  Prices   Latitude  Longitude  \\\n",
       "0    Lisbon                Alenquer     686  39.056633  -9.007606   \n",
       "1    Lisbon                 Amadora    1006  38.759516  -9.223677   \n",
       "2    Lisbon       Arruda dos Vinhos     846  38.975148  -9.087703   \n",
       "3    Lisbon                Azambuja     675  39.068988  -8.868492   \n",
       "4    Lisbon                 Cadaval     534  39.239574  -9.062203   \n",
       "5    Lisbon                 Cascais    1893  38.722400  -9.396909   \n",
       "6    Lisbon                  Lisboa    2315  38.707751  -9.136592   \n",
       "7    Lisbon                  Loures    1251  38.830874  -9.168451   \n",
       "8    Lisbon                Lourinhã     823  39.246033  -9.271339   \n",
       "9    Lisbon                   Mafra    1037  38.936978  -9.328237   \n",
       "10   Lisbon                Odivelas    1243  38.792634  -9.182670   \n",
       "11   Lisbon                  Oeiras    1572  38.712497  -9.271300   \n",
       "12   Lisbon                  Sintra     853  38.835560  -9.352225   \n",
       "13   Lisbon  Sobral de Monte Agraço     630  39.018350  -9.151710   \n",
       "14   Lisbon           Torres Vedras     863  39.093086  -9.260741   \n",
       "15   Lisbon     Vila Franca de Xira     938  38.954278  -8.989704   \n",
       "\n",
       "    Cluster Labels  1st Most Common Venue  2nd Most Common Venue  \\\n",
       "0              1.0                    Bar               Wine Bar   \n",
       "1              0.0             Restaurant  Portuguese Restaurant   \n",
       "2              NaN                    NaN                    NaN   \n",
       "3              1.0          Shopping Mall          Train Station   \n",
       "4              NaN                    NaN                    NaN   \n",
       "5              4.0            Golf Course               Wine Bar   \n",
       "6              1.0  Portuguese Restaurant                  Hotel   \n",
       "7              0.0             Restaurant         Breakfast Spot   \n",
       "8              3.0                   Café               Wine Bar   \n",
       "9              1.0                   Café                 Bakery   \n",
       "10             1.0  Portuguese Restaurant                   Café   \n",
       "11             0.0             Restaurant             Playground   \n",
       "12             2.0    Arts & Crafts Store   Gym / Fitness Center   \n",
       "13             3.0                   Café  Portuguese Restaurant   \n",
       "14             1.0                    Bar       Tapas Restaurant   \n",
       "15             1.0  Portuguese Restaurant                    Bar   \n",
       "\n",
       "     3rd Most Common Venue  4th Most Common Venue  5th Most Common Venue  \\\n",
       "0     Other Great Outdoors                 Bakery  Portuguese Restaurant   \n",
       "1                      Gym             Playground                 Bakery   \n",
       "2                      NaN                    NaN                    NaN   \n",
       "3                     Café  Portuguese Restaurant                 Garden   \n",
       "4                      NaN                    NaN                    NaN   \n",
       "5   Furniture / Home Store            Coffee Shop         Cosmetics Shop   \n",
       "6           Ice Cream Shop                  Plaza                    Bar   \n",
       "7                  Stadium            Coffee Shop       Business Service   \n",
       "8   Furniture / Home Store            Coffee Shop         Cosmetics Shop   \n",
       "9    Portuguese Restaurant             Restaurant            Pizza Place   \n",
       "10             Pizza Place     Seafood Restaurant                    Gym   \n",
       "11   Portuguese Restaurant                 Garden           Soccer Field   \n",
       "12          Breakfast Spot               Wine Bar                 Garden   \n",
       "13                  Garden               Wine Bar   Fast Food Restaurant   \n",
       "14                   Hotel                Brewery             Restaurant   \n",
       "15     Japanese Restaurant          Train Station       Sushi Restaurant   \n",
       "\n",
       "         6th Most Common Venue 7th Most Common Venue  \\\n",
       "0   Modern European Restaurant                  Café   \n",
       "1                  Supermarket         Metro Station   \n",
       "2                          NaN                   NaN   \n",
       "3                        Diner        Scenic Lookout   \n",
       "4                          NaN                   NaN   \n",
       "5                        Diner     Electronics Store   \n",
       "6                     Wine Bar           Coffee Shop   \n",
       "7        Portuguese Restaurant        Soccer Stadium   \n",
       "8                        Diner     Electronics Store   \n",
       "9             Botanical Garden                Castle   \n",
       "10        Fast Food Restaurant           Event Space   \n",
       "11           Electronics Store                  City   \n",
       "12              Cosmetics Shop                 Diner   \n",
       "13                 Coffee Shop        Cosmetics Shop   \n",
       "14                        Café         Historic Site   \n",
       "15                       Diner                Garden   \n",
       "\n",
       "       8th Most Common Venue 9th Most Common Venue 10th Most Common Venue  \n",
       "0       Fast Food Restaurant                 Diner      Electronics Store  \n",
       "1                   Wine Bar     Electronics Store            Coffee Shop  \n",
       "2                        NaN                   NaN                    NaN  \n",
       "3                Event Space        Clothing Store            Coffee Shop  \n",
       "4                        NaN                   NaN                    NaN  \n",
       "5                Event Space  Fast Food Restaurant                 Garden  \n",
       "6                 Restaurant                Hostel       Tapas Restaurant  \n",
       "7                       Park                   Bar              BBQ Joint  \n",
       "8                Event Space  Fast Food Restaurant                 Garden  \n",
       "9                Coffee Shop                 Plaza           Burger Joint  \n",
       "10  Mediterranean Restaurant                  Park                   Pool  \n",
       "11            Clothing Store           Coffee Shop         Cosmetics Shop  \n",
       "12         Electronics Store           Event Space   Fast Food Restaurant  \n",
       "13                     Diner     Electronics Store            Event Space  \n",
       "14                    Market                Bakery             Bagel Shop  \n",
       "15                      Café                Market          Shopping Mall  "
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# add clustering labels\n",
    "neighborhoods_venues_sorted.insert(0, 'Cluster Labels', kmeans.labels_)\n",
    "\n",
    "manhattan_merged = Prices_GPS\n",
    "\n",
    "# merge toronto_grouped with toronto_data to add latitude/longitude for each neighborhood\n",
    "manhattan_merged = manhattan_merged.join(neighborhoods_venues_sorted.set_index('County'), on='County')\n",
    "\n",
    "manhattan_merged # check the last columns!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\jvsantos\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  This is separate from the ipykernel package so we can avoid doing imports until\n"
     ]
    }
   ],
   "source": [
    "manhattan_merged = manhattan_merged.dropna()\n",
    "manhattan_merged\n",
    "manhattan_merged['Cluster Labels'] =manhattan_merged['Cluster Labels'].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.cm as cm\n",
    "import matplotlib.colors as colors\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "Lisbon = 'Lisbon, LX'\n",
    "\n",
    "geolocator = Nominatim(user_agent=\"ny_explorer\")\n",
    "location = geolocator.geocode(Lisbon)\n",
    "latitude = location.latitude\n",
    "longitude = location.longitude"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import json\n",
    "import geojson\n",
    "import webbrowser"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\jvsantos\\Anaconda3\\lib\\site-packages\\pandas\\core\\indexing.py:190: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  self._setitem_with_indexer(indexer, value)\n"
     ]
    }
   ],
   "source": [
    "PP = Prices_GPS\n",
    "\n",
    "PP[\"County\"].iloc[[13]] = \"Sobral de Monte Agrao\"\n",
    "PP[\"County\"].iloc[[8]] = \"Lourinha\"\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\jvsantos\\Anaconda3\\lib\\site-packages\\ipykernel_launcher.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  \"\"\"Entry point for launching an IPython kernel.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>District</th>\n",
       "      <th>County</th>\n",
       "      <th>Prices</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Cluster Labels</th>\n",
       "      <th>1st Most Common Venue</th>\n",
       "      <th>2nd Most Common Venue</th>\n",
       "      <th>3rd Most Common Venue</th>\n",
       "      <th>4th Most Common Venue</th>\n",
       "      <th>5th Most Common Venue</th>\n",
       "      <th>6th Most Common Venue</th>\n",
       "      <th>7th Most Common Venue</th>\n",
       "      <th>8th Most Common Venue</th>\n",
       "      <th>9th Most Common Venue</th>\n",
       "      <th>10th Most Common Venue</th>\n",
       "      <th>Cluster NR</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>1</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Other Great Outdoors</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Modern European Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "      <td>38.759516</td>\n",
       "      <td>-9.223677</td>\n",
       "      <td>0</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Gym</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Supermarket</td>\n",
       "      <td>Metro Station</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "      <td>39.068988</td>\n",
       "      <td>-8.868492</td>\n",
       "      <td>1</td>\n",
       "      <td>Shopping Mall</td>\n",
       "      <td>Train Station</td>\n",
       "      <td>Café</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Scenic Lookout</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Clothing Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "      <td>38.722400</td>\n",
       "      <td>-9.396909</td>\n",
       "      <td>4</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Furniture / Home Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "      <td>38.707751</td>\n",
       "      <td>-9.136592</td>\n",
       "      <td>1</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Hotel</td>\n",
       "      <td>Ice Cream Shop</td>\n",
       "      <td>Plaza</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Hostel</td>\n",
       "      <td>Tapas Restaurant</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  District    County  Prices   Latitude  Longitude  Cluster Labels  \\\n",
       "0   Lisbon  Alenquer     686  39.056633  -9.007606               1   \n",
       "1   Lisbon   Amadora    1006  38.759516  -9.223677               0   \n",
       "3   Lisbon  Azambuja     675  39.068988  -8.868492               1   \n",
       "5   Lisbon   Cascais    1893  38.722400  -9.396909               4   \n",
       "6   Lisbon    Lisboa    2315  38.707751  -9.136592               1   \n",
       "\n",
       "   1st Most Common Venue  2nd Most Common Venue   3rd Most Common Venue  \\\n",
       "0                    Bar               Wine Bar    Other Great Outdoors   \n",
       "1             Restaurant  Portuguese Restaurant                     Gym   \n",
       "3          Shopping Mall          Train Station                    Café   \n",
       "5            Golf Course               Wine Bar  Furniture / Home Store   \n",
       "6  Portuguese Restaurant                  Hotel          Ice Cream Shop   \n",
       "\n",
       "   4th Most Common Venue  5th Most Common Venue       6th Most Common Venue  \\\n",
       "0                 Bakery  Portuguese Restaurant  Modern European Restaurant   \n",
       "1             Playground                 Bakery                 Supermarket   \n",
       "3  Portuguese Restaurant                 Garden                       Diner   \n",
       "5            Coffee Shop         Cosmetics Shop                       Diner   \n",
       "6                  Plaza                    Bar                    Wine Bar   \n",
       "\n",
       "  7th Most Common Venue 8th Most Common Venue 9th Most Common Venue  \\\n",
       "0                  Café  Fast Food Restaurant                 Diner   \n",
       "1         Metro Station              Wine Bar     Electronics Store   \n",
       "3        Scenic Lookout           Event Space        Clothing Store   \n",
       "5     Electronics Store           Event Space  Fast Food Restaurant   \n",
       "6           Coffee Shop            Restaurant                Hostel   \n",
       "\n",
       "  10th Most Common Venue  Cluster NR  \n",
       "0      Electronics Store           1  \n",
       "1            Coffee Shop           0  \n",
       "3            Coffee Shop           1  \n",
       "5                 Garden           4  \n",
       "6       Tapas Restaurant           1  "
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "manhattan_merged[\"Cluster NR\"] = manhattan_merged[\"Cluster Labels\"]\n",
    "manhattan_merged.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\jvsantos\\Anaconda3\\lib\\site-packages\\pandas\\core\\indexing.py:543: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  self.obj[item] = s\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>District</th>\n",
       "      <th>County</th>\n",
       "      <th>Prices</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Cluster Labels</th>\n",
       "      <th>1st Most Common Venue</th>\n",
       "      <th>2nd Most Common Venue</th>\n",
       "      <th>3rd Most Common Venue</th>\n",
       "      <th>4th Most Common Venue</th>\n",
       "      <th>5th Most Common Venue</th>\n",
       "      <th>6th Most Common Venue</th>\n",
       "      <th>7th Most Common Venue</th>\n",
       "      <th>8th Most Common Venue</th>\n",
       "      <th>9th Most Common Venue</th>\n",
       "      <th>10th Most Common Venue</th>\n",
       "      <th>Cluster NR</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Alenquer</td>\n",
       "      <td>686</td>\n",
       "      <td>39.056633</td>\n",
       "      <td>-9.007606</td>\n",
       "      <td>Cafe &amp; Bar Venues</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Other Great Outdoors</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Modern European Restaurant</td>\n",
       "      <td>Café</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Amadora</td>\n",
       "      <td>1006</td>\n",
       "      <td>38.759516</td>\n",
       "      <td>-9.223677</td>\n",
       "      <td>Restaurant &amp; Sport Venues</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Gym</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Bakery</td>\n",
       "      <td>Supermarket</td>\n",
       "      <td>Metro Station</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Azambuja</td>\n",
       "      <td>675</td>\n",
       "      <td>39.068988</td>\n",
       "      <td>-8.868492</td>\n",
       "      <td>Cafe &amp; Bar Venues</td>\n",
       "      <td>Shopping Mall</td>\n",
       "      <td>Train Station</td>\n",
       "      <td>Café</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Scenic Lookout</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Clothing Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Cascais</td>\n",
       "      <td>1893</td>\n",
       "      <td>38.722400</td>\n",
       "      <td>-9.396909</td>\n",
       "      <td>Golf &amp; Social Venues</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Furniture / Home Store</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Cosmetics Shop</td>\n",
       "      <td>Diner</td>\n",
       "      <td>Electronics Store</td>\n",
       "      <td>Event Space</td>\n",
       "      <td>Fast Food Restaurant</td>\n",
       "      <td>Garden</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Lisbon</td>\n",
       "      <td>Lisboa</td>\n",
       "      <td>2315</td>\n",
       "      <td>38.707751</td>\n",
       "      <td>-9.136592</td>\n",
       "      <td>Cafe &amp; Bar Venues</td>\n",
       "      <td>Portuguese Restaurant</td>\n",
       "      <td>Hotel</td>\n",
       "      <td>Ice Cream Shop</td>\n",
       "      <td>Plaza</td>\n",
       "      <td>Bar</td>\n",
       "      <td>Wine Bar</td>\n",
       "      <td>Coffee Shop</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Hostel</td>\n",
       "      <td>Tapas Restaurant</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  District    County  Prices   Latitude  Longitude             Cluster Labels  \\\n",
       "0   Lisbon  Alenquer     686  39.056633  -9.007606          Cafe & Bar Venues   \n",
       "1   Lisbon   Amadora    1006  38.759516  -9.223677  Restaurant & Sport Venues   \n",
       "3   Lisbon  Azambuja     675  39.068988  -8.868492          Cafe & Bar Venues   \n",
       "5   Lisbon   Cascais    1893  38.722400  -9.396909       Golf & Social Venues   \n",
       "6   Lisbon    Lisboa    2315  38.707751  -9.136592          Cafe & Bar Venues   \n",
       "\n",
       "   1st Most Common Venue  2nd Most Common Venue   3rd Most Common Venue  \\\n",
       "0                    Bar               Wine Bar    Other Great Outdoors   \n",
       "1             Restaurant  Portuguese Restaurant                     Gym   \n",
       "3          Shopping Mall          Train Station                    Café   \n",
       "5            Golf Course               Wine Bar  Furniture / Home Store   \n",
       "6  Portuguese Restaurant                  Hotel          Ice Cream Shop   \n",
       "\n",
       "   4th Most Common Venue  5th Most Common Venue       6th Most Common Venue  \\\n",
       "0                 Bakery  Portuguese Restaurant  Modern European Restaurant   \n",
       "1             Playground                 Bakery                 Supermarket   \n",
       "3  Portuguese Restaurant                 Garden                       Diner   \n",
       "5            Coffee Shop         Cosmetics Shop                       Diner   \n",
       "6                  Plaza                    Bar                    Wine Bar   \n",
       "\n",
       "  7th Most Common Venue 8th Most Common Venue 9th Most Common Venue  \\\n",
       "0                  Café  Fast Food Restaurant                 Diner   \n",
       "1         Metro Station              Wine Bar     Electronics Store   \n",
       "3        Scenic Lookout           Event Space        Clothing Store   \n",
       "5     Electronics Store           Event Space  Fast Food Restaurant   \n",
       "6           Coffee Shop            Restaurant                Hostel   \n",
       "\n",
       "  10th Most Common Venue  Cluster NR  \n",
       "0      Electronics Store           1  \n",
       "1            Coffee Shop           0  \n",
       "3            Coffee Shop           1  \n",
       "5                 Garden           4  \n",
       "6       Tapas Restaurant           1  "
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "manhattan_merged.loc[manhattan_merged['Cluster Labels'] == 1, 'Cluster Labels'] = \"Cafe & Bar Venues\"\n",
    "manhattan_merged.loc[manhattan_merged['Cluster Labels'] == 0, 'Cluster Labels'] = \"Restaurant & Sport Venues\"\n",
    "manhattan_merged.loc[manhattan_merged['Cluster Labels'] == 2, 'Cluster Labels'] = \"Store Venues\"\n",
    "manhattan_merged.loc[manhattan_merged['Cluster Labels'] == 3, 'Cluster Labels'] = \"Local Restaurants Venues\"\n",
    "manhattan_merged.loc[manhattan_merged['Cluster Labels'] == 4, 'Cluster Labels'] = \"Golf & Social Venues\"\n",
    "\n",
    "\n",
    "manhattan_merged.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# create map\n",
    "map_clusters = folium.Map(location=[latitude, longitude], zoom_start=9)\n",
    "\n",
    "# set color scheme for the clusters\n",
    "x = np.arange(kclusters)\n",
    "ys = [i + x + (i*x)**2 for i in range(kclusters)]\n",
    "colors_array = cm.rainbow(np.linspace(0, 1, len(ys)))\n",
    "rainbow = [colors.rgb2hex(i) for i in colors_array]\n",
    "\n",
    "state_geo = r\"done.geojson\"\n",
    "folium.Choropleth(geo_data=state_geo, data=PP, columns=[\"County\", \"Prices\"], key_on=\"feature.properties.neighbourhood\", fill_color='YlOrRd', fill_opacity = 0.7, line_opacity=0.2, legend_name=\"Prices in Lisbon\").add_to(map_clusters)\n",
    "    \n",
    "\n",
    "# add markers to the map\n",
    "markers_colors = []\n",
    "for lat, lon, poi, cluster, nr in zip(manhattan_merged['Latitude'], manhattan_merged['Longitude'], manhattan_merged['County'], manhattan_merged['Cluster NR'], manhattan_merged['Cluster Labels']):\n",
    "    label = folium.Popup(str(poi) + ' - ' + str(nr), parse_html=True)\n",
    "    folium.CircleMarker(\n",
    "        [lat, lon],\n",
    "        radius=10,\n",
    "        popup=label,\n",
    "        color=rainbow[cluster-1],\n",
    "        fill=True,\n",
    "        fill_color=rainbow[cluster-1],\n",
    "        fill_opacity=0.7).add_to(map_clusters)\n",
    "    \n",
    "\n",
    "\n",
    "map_clusters\n",
    "map_clusters.save('map.html')\n",
    "webbrowser.open('map.html')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
